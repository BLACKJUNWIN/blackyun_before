{"remainingRequest":"D:\\BlackJun\\2021\\program\\webstrom\\yun\\node_modules\\vue-loader-v16\\dist\\index.js??ref--1-1!D:\\BlackJun\\2021\\program\\webstrom\\yun\\src\\views\\more.vue?vue&type=style&index=0&id=e2be5022&scoped=true&lang=css","dependencies":[{"path":"D:\\BlackJun\\2021\\program\\webstrom\\yun\\src\\views\\more.vue","mtime":1660024301781},{"path":"D:\\BlackJun\\2021\\program\\webstrom\\yun\\node_modules\\css-loader\\dist\\cjs.js","mtime":1659339946691},{"path":"D:\\BlackJun\\2021\\program\\webstrom\\yun\\node_modules\\vue-loader-v16\\dist\\stylePostLoader.js","mtime":1659339951534},{"path":"D:\\BlackJun\\2021\\program\\webstrom\\yun\\node_modules\\postcss-loader\\src\\index.js","mtime":1659339948085},{"path":"D:\\BlackJun\\2021\\program\\webstrom\\yun\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1659339948891},{"path":"D:\\BlackJun\\2021\\program\\webstrom\\yun\\node_modules\\vue-loader-v16\\dist\\index.js","mtime":1659339949079}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ci5maWxlOmhvdmVyewogIGJveC1zaGFkb3c6IDAgMCAxMHB4IGdyZXk7Cn0KLmZpbGVTdHlsZXsKICBmb250LXNpemU6IDE2cHg7CiAgbWFyZ2luLXRvcDogMTNweDsKfQo="},{"version":3,"sources":["D:\\BlackJun\\2021\\program\\webstrom\\yun\\src\\views\\more.vue"],"names":[],"mappings":";AA+LA,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;EACT,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,EAAE,EAAE,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC;AAC3B;AACA,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;EACR,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC;EACf,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC;AAClB","file":"D:/BlackJun/2021/program/webstrom/yun/src/views/more.vue","sourceRoot":"","sourcesContent":["<template>\n  <div style=\"width:80%;margin:0 auto;\">\n    <div>\n      <el-button type=\"primary\" style=\"margin-top: 20px;height: 36px;\" @click=\"backLevel()\" :disabled=\"$route.query.path==='/'\"><Back style=\"width: 1em; height: 1em; margin-right: 8px\"/>返回</el-button>\n    </div>\n    <div style=\"margin-top:20px\">\n      <el-breadcrumb separator=\"/\">\n        <el-breadcrumb-item :to=\"{path:'/more',query:{path:'/'}}\">黑盘</el-breadcrumb-item>\n        <el-breadcrumb-item v-for=\"(item,index) in records\" :key=\"index\">{{item}}</el-breadcrumb-item>\n      </el-breadcrumb>\n    </div>\n    <div style=\"display: flex;width: 100%;height: auto;flex-wrap: wrap;box-shadow: 0 0 8px rgba(128,128,128,0.8);background-color:#fafafa;border-radius: 1.5em;margin-top:20px;padding:50px 0\">\n      <div v-for=\"(item,index) in currentPack\" :key=\"index\"  style=\"width:10%;height: auto;text-align: center;margin:30px;padding:15px 20px;border-radius:1em;cursor: pointer;transition: all 600ms\" class=\"file\" :title=\"item.fileName+'.'+item.type\" @contextmenu.prevent=\"currentFile=item;fileManage=true;\" @click=\"enterFile(item)\">\n        <img :src=\"getType(item.type)\" style=\"width:75%\"/>\n        <span style=\"font-size:16px;overflow: hidden;text-overflow: ellipsis;white-space: nowrap;width:100%;display: inline-block;margin-top:8px\">{{item.fileName}}</span>\n      </div>\n      <div v-if=\"currentPack===null||currentPack.length<=0\" style=\"text-align: center;width: 100%\">\n        <img src=\"@/assets/images/none.svg\"/>\n        <div style=\"font-weight: bold;font-size: 20px;color: #61b3ec\"><span style=\"color: black\">黑</span>盘里什么也没有</div>\n      </div>\n    </div>\n\n    <div style=\"display: flex;justify-content: right;margin:30px 0;width: 100%;\">\n      <el-button type=\"success\" plain style=\"font-weight: bold;height: 36px\" @click=\"addMkdir=true;\">新建文件夹</el-button>\n    </div>\n    <!--    文件操作弹窗-->\n    <el-dialog\n      title=\"文件管理\"\n      v-model=\"fileManage\"\n      width=\"41%\"\n      center>\n      <div style=\"display:flex;width:80%;height: 200px;text-align: center;margin:10px auto 0 auto;\" v-if=\"currentFile!=null||currentFile!=={}\">\n        <div>\n          <img :src=\"getType(currentFile.type)\" style=\"height:100%\" alt=\"样式\"/>\n        </div>\n        <div style=\"text-align: left;display: flex;flex-flow: column;justify-content: space-between;height: 160px;margin-top:10px\">\n          <div class=\"fileStyle\"><strong>文件名:</strong>&nbsp;{{currentFile.fileName}}</div>\n          <div class=\"fileStyle\"><strong>类型:</strong>&nbsp;{{currentFile.type}}</div>\n          <div class=\"fileStyle\"><strong>路径<br></strong>黑盘{{currentFile.level}}{{currentFile.fileName}}.{{currentFile.type}}</div>\n          <div class=\"fileStyle\"><strong>大小<br></strong>{{(currentFile.size/1024).toFixed(3)}}KB&nbsp,&nbsp约{{(parseFloat(currentFile.size)/1024/1024).toFixed(2)}}MB</div>\n        </div>\n      </div>\n      <span slot=\"footer\" class=\"dialog-footer\" style=\"display: flex;justify-content: center;margin-top: 25px\">\n        <el-button type=\"info\" @click=\"fileManage = false\">取 消</el-button>\n        <el-button type=\"danger\" @click=\"fileManage = false;deleteFile()\">删除</el-button>\n        <el-button type=\"success\" @click=\"fileManage = false;onlineFile()\" :disabled=\"!(currentFile.type==='txt'||currentFile.type==='jpg'||currentFile.type==='png'||currentFile.type==='xml')\" title=\"仅支持txt,jpg,png格式\">预览</el-button>\n        <el-button type=\"primary\"  @click=\"fileManage = false;downFile(currentFile)\">下载</el-button>\n       </span>\n    </el-dialog>\n    <!--    文件操作弹窗-->\n    <el-dialog title=\"新增文件夹\"\n               v-model=\"addMkdir\"\n               width=\"30%\"\n               center>\n      <el-form-item label=\"文件名\" style=\"font-weight: bold\">\n        <el-input name='fileName' v-model=\"mkdirName\" placeholder=\"请输入文件名\"></el-input>\n      </el-form-item>\n      <span slot=\"footer\" class=\"dialog-footer\" style=\"display: flex;justify-content: center;margin-top: 25px;\">\n        <el-button type=\"info\" @click=\"addMkdir = false\" style=\"width:60px;height: 36px;\">取 消</el-button>\n        <el-button type=\"success\" style=\"width:60px;height: 36px\" @click=\"newMkdir()\">新增</el-button>\n       </span>\n    </el-dialog>\n\n  </div>\n</template>\n\n<script>\nimport {Back} from \"@element-plus/icons\";\nimport {showPack,removeFilePath,net_newMkdir} from \"@/net/file\";\nimport {useRoute,useRouter} from \"vue-router\";\nimport {reactive, toRefs,watch} from \"vue\";\nimport {useStore} from \"vuex\";\nimport {RealBaseUrl} from \"@/net/request\";\nimport store from \"vuex\";\nexport default {\n  name: \"more\",\n  components:{\n    Back\n  },\n  setup(){\n    const route=useRoute();\n    const router=useRouter();\n    const store=useStore();\n    watch(route,(newValue,oldValue)=>{\n      enterPack();\n    })\n\n    //基础属性\n    let fileData=reactive({\n      currentPack:[],\n      currentFile:{},\n      fileManage:false,\n      addMkdir:false,\n      mkdirName:\"\",\n      records:[],\n    })\n\n    //进入对应文件夹\n    let enterPack=async ()=>{\n      fileData.currentPack=(await showPack({\n        \"level\": route.query.path\n      })).data;\n      fileData.records=route.query.path.substring(1).split(\"/\");\n    }\n    //进入文件时\n    let enterFile=(file)=>{\n      if(file.type===\"pack\"){\n        router.push({path:\"/more\",query:{path:file.level+file.fileName+\"/\"}})\n        enterPack();\n      }else{\n        fileData.currentFile=file;\n        fileData.fileManage=true;\n      }\n    }\n\n    //获取文件样式并展示对应样式图片\n    let getType=(type)=>{\n      try {\n        return require(\"@/assets/images/fileType/\" + type + \".svg\");\n      } catch (e) {\n        return require(\"@/assets/images/fileType/null.svg\");\n      }\n    }\n\n    //返回上一级\n    let backLevel=()=>{\n      let level = route.query.path.substring(0,route.query.path.length-1);\n      let oldLevel=level.substring(0,level.lastIndexOf(\"/\")+1)\n      if(oldLevel.length<=0){\n        oldLevel=\"/\";\n      }\n      router.push({path:\"/more\",query:{path:oldLevel}});\n      enterPack();\n    }\n\n    //删除文件路径\n    let deleteFile=async ()=>{\n      let res=await removeFilePath(fileData.currentFile.id);\n      store.commit(\"tip\",res);\n      await enterPack();\n    }\n\n    //在线浏览文件\n    let onlineFile=()=>{\n      window.open(RealBaseUrl+\"/upload/\"+fileData.currentFile.realName,'_blank');\n    }\n\n    //下载文件\n    let downFile=()=>{\n      window.open(RealBaseUrl+\"/v1/down?md5=\"+fileData.currentFile.md5, '_blank');\n    }\n\n    //新增文件夹\n    let newMkdir=async ()=>{\n      if(fileData.mkdirName===\"\"){\n        let res={\n          code:\"500\",\n          message:\"请先输入文件名\"\n        }\n        store.commit(\"tip\",res);\n      }else{\n        let res=await net_newMkdir({\n          fileName:fileData.mkdirName,\n          level:route.query.path\n        })\n        await enterPack();\n        fileData.mkdirName=\"\";\n        store.commit(\"tip\",res);\n        fileData.addMkdir=false;\n      }\n    }\n\n    return {\n      ...toRefs(fileData),\n      getType,\n      enterPack,\n      enterFile,\n      backLevel,\n      deleteFile,\n      onlineFile,\n      downFile,\n      newMkdir\n    }\n  },\n  created(){\n    this.enterPack();\n  },\n}\n</script>\n\n<style scoped>\n.file:hover{\n  box-shadow: 0 0 10px grey;\n}\n.fileStyle{\n  font-size: 16px;\n  margin-top: 13px;\n}\n</style>\n"]}]}